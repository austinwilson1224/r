---
title: Random Variables
author: TODO
date: 27 September 2020
---

#### Outcomes

- Implement mathematical expressions in user defined functions
- Write vectorized functions
- Translate word problems and game rules into mathematics and code


#### Background

In this assignment we'll practice writing random variables using the game of Roulette.
We'll use them in the next assignment to analyze and understand the game.

A European roulette wheel has numbers 1-36 in red and black, and number 0 in green for a house win.
The dealer spins the board, and the the ball lands randomly on one of these 37 numbers.
Here's a brief [video introducing the rules of roulette](https://youtu.be/6nKBlWaRI8w).

#### Instructions

- Answer the following questions, and show all your R code.
- Upload your submission to Canvas in nicely formatted HTML generated from Rstudio.

In the code that follows, think of `x` as a random variable uniformly distributed on the integers 0 through 36, representing the possible values for a game of roulette.
Here's one way to produce a vector containing a sample of size `n` from `x`.

```{r}
n = 100
roulette_values = 0:36
x = sample(roulette_values, size = n, replace = TRUE)
tbl = table(x)
tbl
```

# Questions

## 1 - outside bet -- double your money payout is 1:1 (bet $1 and win you get $1, lose -- lose $1)

(3 points)

The elements of our sample space are the roulette numbers: {0, 1, ..., 36}.
In statistics, a random variable is a function that maps an element of the sample space to a real number.
Let h(x) be a random variable representing the amount you win or lose for a bet on the high numbers defined as follows:

$$
h(x) = \begin{cases}
-1 &\mbox{if } x \leq 18 \\
1 & \mbox{if } 18 < x
\end{cases}
$$

Define a vectorized function `high` that accepts a sample vector `x` and implements `h(x)`.

```{r}
#  high
high = function(x, amount_bet = 1) {
  win = x > 18
  # ifelse(win, 1, -1)
  ifelse(win, amount_bet,  -amount_bet) 
}
high_wins = high(x)
tbl = table(high_wins)
tbl
sum(tbl)
relative_tbl = tbl / sum(tbl)
relative_tbl
e_x = (-1) * relative_tbl[1] + (1) * relative_tbl[2]
e_x
```

Hint: Use `even(x)` below as a template.

```{r}
even = function(x)
{
    win = (x %% 2 == 0) & (x != 0)
    ifelse(win, 1, -1)
}
```


## 2

(3 points)

Define a vectorized function `low` that accepts a sample vector `x` and returns the amount you win or lose if you bet one unit money on the low numbers, from 1 to 18.
Hint: you lose if X = 0.

```{r}
# TODO define low
low = function(x, amount_bet = 1) {
  win = x <= 18 & x >= 1
  # sum(win) - sum(!win)
  ifelse(win, 1,-1)
}
low(x)
tbl = table(low(x))
relative_tbl = tbl / sum(tbl)
relative_tbl
e_x = (-1) * relative_tbl[1] + (1) * relative_tbl[2]
e_x
```


## 3 - straight up

(3 points)

Define a vectorized function `straightup` that accepts `x`, a sample vector, and `d`, a digit between  0 and 36, and returns the amount you win or lose in roulette if you bet one unit money on the single value `d`.

```{r}
# TODO define straightup if you win straighup then you get 36 * your money back 
straightup = function(x, d, amount_bet = 1) {
  win = x == d
  lose = x != d
  # print(sum(win) + sum(lose))
  # sum(win) * amount_bet - sum(lose)
  ifelse(win, 35, -1)
}
straightup(x, 3)
tbl = table(straightup(x,3))
relative_tbl = tbl / sum(tbl)
relative_tbl
e_x = (-1) * relative_tbl[1] + (35) * relative_tbl[2]
e_x
```


## 4 - something different

(7 points)

Pick another possible roulette bet that does not have a 1 to 1 payout, and implement an appropriately named vectorized function that accepts `x`, and returns the amount you win or lose in roulette if you bet one unit of money on the single value `d`.
Write it in mathematical notation below as f(x).

$$
first\_dozen(x) = \begin{cases}
-1 &\mbox{if } x > 12  \mbox{ or} \ x = 0\\
2 & \mbox{if } 2 \leq x \leq 12
\end{cases}
$$



```{r}
# first dozen
first_dozen = function(x) {
  win = x %in% 1:12
  # sum(win) * 2 - sum(!win)
  ifelse(win, 2, -1)
}
first_dozen(x)

# second dozen
second_dozen = function(x) {
  win = x %in% 13:24
  # sum(win) * 2 - sum(!win)
  ifelse(win,2, -1)
}
second_dozen(x)
thrid_dozen = function(x) {
  win = x %in% 25:36
  # sum(win) * 2 - sum(!win)
  ifelse(win, 2, -1)
}
thrid_dozen(x)
```


```{r}
# expected value
tbl = table(first_dozen(x))
relative_tbl = tbl / sum(tbl)
relative_tbl
e_x = (-1) * relative_tbl[1] + (2) * relative_tbl[2]
e_x
```



```{r}
# column bet 
column1 = function(x) {
  win = x %in% c(1,4,7,10,13,16,19,22,25,28,31,34)
  # sum(win) * 2 - sum(!win)
  ifelse(win, 2, -1)
}
column1(x)
column2 = function(x) {
  win = x %in% c(2,5,8,11,14,17,20,23,26,29,32,35)
  # sum(win) * 2 - sum(!win)
  ifelse(win, 2, -1)
}
column2(x)
column3 = function(x) {
  win = x %in% c(3,6,9,12,15,18,21,24,27,30,33,36)
  # sum(win) * 2 - sum(!win)
  ifelse(win, 2, -1)
}
column3(x)
```
```{r}
# top line .... payout 8x bet
top_line = function(x) {
  win = ((x == 0) | (x == 1) | (x == 2) | (x == 3))
  # sum(win) * 8 - sum(!win)
  ifelse(win, 8, -1)
}
top_line(x)
table(x)
```

```{r}
# street 11x payout street1 is default (1,2,3)
street = function(x, street = c(1,2,3)) {
  win = x %in% street
  # sum(win) * 11 - sum(!win)
  ifelse(win, 11, -1)
}

street1 = c(1,2,3)
street(x,street1)
```



## 5

(4 points)

Calculate the expected value of your winnings after each play for each of the 4 betting strategies described above.
It should be negative, because the house always wins.

random variable X = winnings... so p(X) is the probability of winning X dollars

E(X) = sum(x * p(x))

X = amount of money won if you bet 1 unit of money on value x 

E[X] = -1 * p(-1) + 1 * p(1)

```{r}
# 1
# expected_value_high = (-1) * (19/37) + (1) * (18/37)



# 2
expected_value_low = (-1) * (19/37) + (1) * (18/37)



# 3
# if you win straight up then you win 35x your money
expected_value_straightup = (-1) * (36/37) + (35) * (1/37)

# 4
# if you win column 1 then you get 2x your money
expected_value_column = (-1) * (25/37) + (2) * (12/37)


expected_value_top_line = (-1) * (33/37) + (8) * (4/37)

expected_value_street = (-1) * (34/37) + (11) * (3/37)






# other expected values 
expected_value_even = (-1) * (19/37) + (1) * (18/37)
expected_value_odd = (-1) * (19/37) + (1) * (18/37)

expected_value_red = (-1) * (19/37) + (1) * (18/37)
expected_value_black = (-1) * (19/37) + (1) * (18/37)
```