---
title: Covid Cases
date: 11 October 2020
---

#### Outcomes

- Download and load public data sets
- Read and interpret metadata
- Evaluate general claims using data, in the presence of missing data
- Create and interpret interaction plots


#### Instructions

- Answer the following questions, and show all your R code.
- Upload your submission to Canvas in nicely formatted HTML generated from Rstudio.

Download the [COVID-19 Case Surveillance Public Use Data](https://data.cdc.gov/Case-Surveillance/COVID-19-Case-Surveillance-Public-Use-Data/vbim-akqf) from the US Center for Disease Control (CDC).
Click on the "Export" button in the top right corner next to download the actual data set.

_Hint: It might be useful to create a new numeric column for severity based on the values of the `hosp, icu, death` columns.
If you do this, make sure you explain the meaning and rationale behind your choices._


# Questions

## 1 - Reading the Documentation

_a) Describe this data set at a high level.
What does each row represent?_

Each row represents a patient. 

_b) How many rows and columns do you expect to see based on the website? 
Load the data into R.
Is this reflected in the data? 

```{r}
covid_data = read.csv("COVID-19_Case_Surveillance_Public_Use_Data.csv")
dim(covid_data)
row_count = dim(covid_data)[1]
```

- I don't see any information on the website about the data set dimensions. The size of the file is 462 MB so I would expect a large dataset, with thousands of rows and a couple columns. 

- Yes. The data set has 4,481,062 rows and 11 columns. More than I anticipated. 


## 2 - Missing Data
 
_There are few `NA` values in this data, but much of the data is missing, unknown, or blank.
Which columns have the highest proportion of missing data?
Why might these be missing?_

```{r}
# onsetdt missing values
# onsetdt_missing = sum(covid_data$onset_dt == "")

# current status missing values
# unique(covid_data$current_status) # none

# # sex missing values
# unique(covid_data$sex)
# sex_unknown = sum(covid_data$sex == "Unknown", na.rm = TRUE)
# sex_missing = sum(covid_data$sex == "Missing", na.rm = TRUE)

# colnames(covid_data)
# for (column in colnames(covid_data)) {
#   
#   # different values possible to count 
#   # "Missing"
#   missing = sum(covid_data[,column] == "Missing", na.rm = TRUE)
# 
#   # unknown
#   unknown = sum(covid_data[,column] == "Unknown", na.rm = TRUE)
# 
#   # "N/A"
#   na = sum(is.na(covid_data[,column]))
# 
#   # blank or ""
#   blank = sum(covid_data[,column] == "", na.rm = TRUE)
#   
#   total = sum(missing,unknown,na,blank)
#   percent_missing = total / row_count
#   
#   
#   print(column)
#   print(total/row_count)
# }

# test = data.frame(colnames(covid_data))
# View(test)

count_missing = function(data) {
  row_count = dim(data)[1]
  # df = data.frame()
  for (column in colnames(data)) {
    # df[,column]
  
    # different values possible to count 
    # "Missing"
    missing = sum(data[,column] == "Missing", na.rm = TRUE)
  
    # unknown
    unknown = sum(data[,column] == "Unknown", na.rm = TRUE)
  
    # "N/A"
    na = sum(is.na(data[,column]))
  
    # blank or ""
    blank = sum(data[,column] == "", na.rm = TRUE)
    
    total = sum(missing,unknown,na,blank)
    percent_missing = total / row_count
    
    result = c(column, total, total/row_count)
    print(result)
    # print(column)
    # print(total)
    # print(total/row_count)
  }
  
}

count_missing(covid_data)



```

- icu_yn has the most values "Missing". These might be missing because they are unknown or the data was unavailable. 


## 3 - Age Risk

_The [CDC states](https://www.cdc.gov/coronavirus/2019-ncov/need-extra-precautions/older-adults.html) "Among adults, the risk for severe illness from COVID-19 increases with age, with older adults at highest risk."
Does the data support this claim?_

_Hint 1: It might be useful to think about these COVID illness rates by age after adjusting for the relative sizes of each age group in the country.
You'll need to bring in another data source to do this._


```{r}
# TODO
# unique(covid_data$age_group)




young_boolean_mask = covid_data$age_group == "0 - 9 Years" | covid_data$age_group ==  "10 - 19 Years" | covid_data$age_group == "20 - 29 Years" 

young = covid_data[young_boolean_mask,]

young_dead = young[young$death_yn == "Yes",]
# young_alive = young[young$death_yn == "No",]

# checking to see the rate at which young people die
dim(young_dead)[1] / dim(young)[1]



mid_boolean_mask = covid_data$age_group == "30 - 39 Years" | covid_data$age_group == "30 - 39 Years" | covid_data$age_group == "40 - 49 Years"
mid = covid_data[mid_boolean_mask,]
mid_dead = mid[mid$death_yn == "Yes",]
dim(mid_dead)[1] / dim(mid)[1]




old_boolean_mask = covid_data$age_group == "50 - 59 Years" | covid_data$age_group == "60 - 69 Years" | covid_data$age_group == "70 - 79 Years" | covid_data$age_group == "80+ Years"
old = covid_data[old_boolean_mask,]
# dim(old)

old_dead = old[old$death_yn == "Yes",]

dim(old_dead)[1] / dim(old)[1]






# exploring dimension of the data set
# dim(young)[1] + dim(mid)[1] + dim(old)[1]
# dim(covid_data)[1]

# unique(covid_data$age_group)


```


TODO - The three values printed are in ascending order the death rates of young, middle aged and elder people. We can see that as age increases so does the death rate. 


## 4 - Medical Condition Risk

_The [CDC states](https://www.cdc.gov/coronavirus/2019-ncov/need-extra-precautions/people-with-medical-conditions.html) "People of any age with certain underlying medical conditions are at increased risk for severe illness from COVID-19"
Does the data support this claim?_

```{r}
# TODO
# unique(covid_data$medcond_yn)
boolean_mask_medcond_death = (covid_data$medcond_yn == "Yes" | covid_data$medcond_yn == "No") & (covid_data$death_yn == "Yes" | covid_data$death_yn == "No")
medcond_alive_or_dead = covid_data[boolean_mask_medcond_death,]



# unique(medcond_alive_or_dead$medcond_yn)
# unique(medcond_alive_or_dead$death_yn)
#  dim(medcond_alive_or_dead)

has_cond_and_alive = medcond_alive_or_dead[(medcond_alive_or_dead$medcond_yn == "Yes" & medcond_alive_or_dead$death_yn == "No"),]
# dim(has_cond_and_alive) # 317,885 rows


dim(has_cond_and_alive)[1] / dim(medcond_alive_or_dead)[1]


has_cond_and_dead = medcond_alive_or_dead[(medcond_alive_or_dead$medcond_yn == "Yes" & medcond_alive_or_dead$death_yn == "Yes"),]
# dim(has_cond_and_dead) # 64,598

dim(has_cond_and_dead)[1] / dim(medcond_alive_or_dead)[1]


no_cond_and_alive = medcond_alive_or_dead[(medcond_alive_or_dead$medcond_yn == "No" & medcond_alive_or_dead$death_yn == "No"),]
# dim(no_cond_and_alive) # 292940 rows

dim(no_cond_and_alive)[1] / dim(medcond_alive_or_dead)[1]


no_cond_and_dead = medcond_alive_or_dead[(medcond_alive_or_dead$medcond_yn == "No" & medcond_alive_or_dead$death_yn == "Yes"),]
# dim(no_cond_and_dead) # 2,257 rows


dim(no_cond_and_dead)[1] / dim(medcond_alive_or_dead)[1]




```

I subsetted the data so that I only have entries that contain data on medical condition and weather or not  they died. We  can see  that more people who have a medical condition die. 


## 5 - Interaction Effects

_In statistics, an __interaction effect__ is when two or more variables have a non additive effect in the value of some response.
In the questions above, we explored the severity of COVID-19 (response) given variables age and medical condition.
Do age and medical condition have an interaction effect in the severity of COVID-19?_

```{r}
# TODO hint: Use interaction.plot
```

TODO - your answer


## 6 - Your Question

_Come up with your own question about COVID-19, and answer it using this data set.
You may want to explore other demographic columns: sex, and race / ethnicity.
You could also look at how the number of cases have changed over time using the report dates._

```{r}
# TODO
```

TODO - Question and answer